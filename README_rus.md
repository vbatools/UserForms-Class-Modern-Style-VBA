# Класс VBA Modern Style

![Пример формы пользователя](User_Forms.gif)

Библиотека классов VBA, которая обеспечивает современный стиль для элементов управления MSForms в приложениях Excel. Этот класс улучшает внешний вид пользовательских форм с помощью современных элементов дизайна, анимаций и улучшенной визуальной обратной связи.

## Особенности

- **Современный дизайн**: Применение стильного, современного оформления к различным элементам управления MSForms
- **Анимация фокуса**: Визуальная обратная связь при получении фокуса с анимированными элементами
- **Настройка цвета**: Настройка цветов для различных состояний элементов управления (активное/неактивное)
- **Поддержка иконок**: Добавление иконок к элементам управления с использованием шрифта Segoe MDL2 Assets
- **Кнопки очистки**: Автоматические кнопки очистки для текстовых полей и комбинированных полей
- **Переключатели**: Современное оформление переключателей для флажков и кнопок выбора
- **Адаптивные метки**: Метки, которые анимируются при вводе данных в элементы управления

## Поддерживаемые элементы управления

- TextBox
- ComboBox
- ListBox
- CheckBox
- OptionButton
- Frame
- Label
- CommandButton

## Установка

1. Скачайте файл `clsModernStyle.cls` из каталога `vba-files/Class/`
2. Импортируйте класс в ваш проект VBA
3. Убедитесь, что в вашем проекте есть ссылка на Microsoft Forms 2.0 Object Library

## Использование

```vba
' Создайте экземпляр класса clsModernStyle
Set style = New clsModernStyle

' Инициализируйте стилизацию для вашей формы пользователя
style.Initialize Me ' где Me - это форма пользователя

' Класс автоматически применяет современную стилизацию ко всем совместимым элементам управления на форме
```

### Расширенное использование с настраиваемыми цветами

```vba
' Инициализация с настраиваемыми цветами
Set style = New clsModernStyle
style.Initialize Me, _
    ColorBarTitleOn:=RGB(0, 100, 200), _
    ColorBarTitleOff:=RGB(120, 120, 120), _
    ColorBarBottomOn:=RGB(0, 100, 200), _
    ColorBarBottomOff:=RGB(180, 180, 180), _
    ColorBackGroundOn:=RGB(255, 255, 255), _
    ColorBackGroundOff:=RGB(245, 245, 245)
```

### Создание переключателей

Чтобы создать переключатель вместо обычного флажка, установите свойство Tag элемента управления в "SWITCH":

```vba
' В конструкторе пользовательской формы установите свойство Tag флажка в "SWITCH"
' Или программно:
MyCheckBox.Tag = "SWITCH"
```

## Иконки

Класс включает перечисление иконок, которые можно использовать с элементами управления:

- ArrowOff, ArrowOn (для выпадающих списков)
- CheckBox1, CheckboxComposite, CheckboxFill
- CheckMark
- CircleFill, CircleRing (для кнопок выбора)
- FavoriteStar, FavoriteStarFill
- Heart, HeartFill
- PasswordChar
- RadioBtnOff, RadioBtnOn
- ToggleOff, ToggleOn, ToggleThumb

## Параметры настройки

Класс позволяет настраивать:

- Размеры шрифта для активных и неактивных состояний
- Цвета для различных элементов управления
- Наборы символов для различных типов элементов управления
- Видимость и состояние доступности элементов управления

## Версия

- Версия: 1.0.8
- Дата создания: 10.10.2025 15:30
- Дата обновления: 01.11.2025 09:59
- Автор: VBATools

## Лицензия

Этот проект лицензирован по Apache License 2.0 - подробности см. в файле [LICENSE](LICENSE).

## Зависимости

- Microsoft Forms 2.0 Object Library
- VBA (Visual Basic for Applications)

## Примеры

Репозиторий включает тестовую форму (`frmTest.frm`), демонстрирующую возможности класса. Вы можете использовать это в качестве справочника для реализации стилизации в своих проектах.

## Доступ к отдельным элементам управления

Класс clsModernStyle предоставляет методы для доступа к отдельным стилизованным элементам управления:

- `getItemByIndex(index As Integer) As clsModernStyle` - Возвращает объект стиля элемента управления по его индексу
- `getItemByName(Name As String) As clsModernStyle` - Возвращает объект стиля элемента управления по его имени

Эти методы позволяют программно изменять внешний вид или поведение конкретных элементов управления после первоначальной стилизации.

## Дополнительные свойства

Класс также предоставляет следующие свойства для управления и получения информации о стилизованных элементах управления:

- `Count As Byte` - Возвращает общее количество стилизованных элементов управления в коллекции
- `Items As Collection` - Возвращает коллекцию всех объектов стилизованных элементов управления
- `Version As String` - Возвращает информацию о версии класса clsModernStyle

## Установка текста заголовка через ControlTipText

Вы можете установить текст заголовка, который появляется над элементами управления, используя свойство `ControlTipText` ваших элементов управления формы. Класс clsModernStyle автоматически использует это свойство для отображения заголовков:

```vba
' Установите свойство ControlTipText в элементах управления вашей формы пользователя
MyTextBox.ControlTipText = "Введите ваше имя"
MyComboBox.ControlTipText = "Выберите опцию"
MyCheckBox.ControlTipText = "Согласиться с условиями"

' Когда вы инициализируете стиль, ControlTipText будет использоваться в качестве заголовка
Set style = New clsModernStyle
style.Initialize Me
```

Заголовок появится над элементом управления, когда он получит фокус, и будет анимироваться до меньшего размера и перемещаться в левый верхний угол, когда элемент управления будет содержать данные.

## Установка иконок

Вы можете установить иконки для элементов управления, используя свойство `Tag` ваших элементов управления формы. Класс clsModernStyle использует это свойство для отображения иконок:

```vba
' Установите свойство Tag в константу иконки из перечисления enumIcons
MyTextBox.Tag = 59193  ' Использование числового значения для иконки
' Или используйте значение enum, если оно доступно в вашей среде VBA
MyComboBox.Tag = "61735"  ' Использование строкового значения для иконки

' Когда вы инициализируете стиль, Tag будет использоваться в качестве иконки
Set style = New clsModernStyle
style.Initialize Me
```

Иконка появится слева от элемента управления. Вы можете использовать любую из констант иконок, определенных в перечислении `enumIcons` в классе clsModernStyle. Иконки отображаются с использованием шрифта Segoe MDL2 Assets.

## Документация

Для получения полной документации см. следующие файлы в папке `docs`:

- [Техническая документация (Русский)](docs/technical_documentation_ru.md)
- [Руководство пользователя (Русский)](docs/user_guide_ru.md)
- [Примеры реализации (Русский)](docs/implementation_examples_ru.md)

## Documentation

For comprehensive documentation, please refer to the following files in the `docs` folder:

- [Technical Documentation (English)](docs/technical_documentation_en.md)
- [User Guide (English)](docs/user_guide_en.md)
- [Implementation Examples (English)](docs/implementation_examples_en.md)