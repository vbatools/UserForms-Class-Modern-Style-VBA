# Класс VBA Modern Style

![Демонстрация проекта](User_Forms.gif)

Этот репозиторий содержит реализацию на VBA библиотеки классов, которая обеспечивает современный стиль для элементов управления MSForms в приложениях Excel. Класс улучшает внешний вид пользовательских форм с помощью современных элементов дизайна, анимаций и улучшенной визуальной обратной связи.

## Содержание
1. [Возможности](#возможности)
2. [Компоненты](#компоненты)
3. [Установка](#установка)
4. [Быстрый старт](#быстрый-старт)
5. [Основные функции](#основные-функции)
6. [Работа с элементами управления](#работа-с-элементами-управления)
7. [Настройка стиля](#настройка-стиля)
8. [Устранение неполадок](#устранение-неполадок)

## Возможности

- **Современный дизайн**: Применение стильного, современного оформления к различным элементам управления MSForms
- **Анимация фокуса**: Визуальная обратная связь при получении фокуса с анимированными элементами
- **Настройка цвета**: Настройка цветов для различных состояний элементов управления (активное/неактивное)
- **Поддержка иконок**: Добавление иконок к элементам управления с использованием шрифта Segoe MDL2 Assets
- **Кнопки очистки**: Автоматические кнопки очистки для текстовых полей и комбинированных полей
- **Переключатели**: Современное оформление переключателей для флажков и кнопок выбора
- **Адаптивные метки**: Метки, которые анимируются при вводе данных в элементы управления

## Компоненты

- `clsModernStyle.cls`: Основная реализация класса
- `frmTest.frm`: Тестовая форма, демонстрирующая использование
- `modShowForms.bas`: Модуль, содержащий функции отображения форм
- Документация в папке `docs/`:
 - [`docs/technical_documentation_ru.md`](docs/technical_documentation_ru.md) - Техническая документация на русском языке
  - [`docs/technical_documentation_en.md`](docs/technical_documentation_en.md) - Техническая документация на английском языке
  - [`docs/user_guide_ru.md`](docs/user_guide_ru.md) - Руководство пользователя на русском языке
  - [`docs/user_guide_en.md`](docs/user_guide_en.md) - Руководство пользователя на английском языке
  - [`docs/implementation_examples_ru.md`](docs/implementation_examples_ru.md) - Примеры реализации на русском языке
  - [`docs/implementation_examples_en.md`](docs/implementation_examples_en.md) - Примеры реализации на английском языке

## Установка

1. Скачайте файл `clsModernStyle.cls` из каталога `vba-files/Class/`
2. Импортируйте класс в ваш проект VBA
3. Убедитесь, что вашем проекте есть ссылка на Microsoft Forms 2.0 Object Library

## Быстрый старт

### Простой пример использования
```vba
' Создайте экземпляр класса clsModernStyle
Set style = New clsModernStyle

' Инициализируйте стилизацию для вашей формы пользователя
style.Initialize Me ' где Me - это форма пользователя

' Класс автоматически применяет современную стилизацию ко всем совместимым элементам управления на форме
```

## Основные функции

- **Инициализация стилизации**: Метод `Initialize` позволяет применить современную стилизацию ко всем совместимым элементам управления на форме
- **Настройка цветов**: Возможность настройки цветов для различных элементов управления и состояний
- **Поддержка иконок**: Использование иконок из шрифта Segoe MDL2 Assets для различных элементов управления
- **Анимации**: Визуальная обратная связь при взаимодействии с элементами управления
- **Кнопки очистки**: Автоматические кнопки очистки для текстовых полей и комбинированных полей

## Работа с элементами управления

Класс `clsModernStyle` поддерживает стилизацию следующих элементов управления:
- TextBox
- ComboBox
- ListBox
- CheckBox
- OptionButton
- Frame
- Label
- CommandButton

Для каждого типа элемента управления реализована соответствующая стилизация, учитывающая особенности взаимодействия с пользователем.

## Настройка стиля

Класс позволяет настраивать:
- Цвета для различных элементов управления
- Шрифты и размеры текста
- Видимость и состояние элементов управления
- Поведение при взаимодействии (анимации, эффекты)

Для настройки цветов можно использовать параметры инициализации:
```vba
' Инициализация с настраиваемыми цветами
Set style = New clsModernStyle
style.Initialize Me, _
    ColorBarTitleOn:=RGB(0, 100, 200), _
    ColorBarTitleOff:=RGB(120, 120, 120), _
    ColorBarBottomOn:=RGB(0, 100, 200), _
    ColorBarBottomOff:=RGB(180, 180, 180), _
    ColorBackGroundOn:=RGB(255, 255, 255), _
    ColorBackGroundOff:=RGB(245, 245, 245)
```

## Устранение неполадок

### Проблемы с отображением
- Убедитесь, что Microsoft Forms 2.0 Object Library включена в ссылки
- Проверьте, что элементы управления добавлены до вызова метода Initialize
- Убедитесь, что свойство MultiUse установлено в True для класса

### Проблемы с взаимодействием
- Проверьте, что события элементов управления не перегружены другими обработчиками
- Убедитесь, что свойства элементов управления не изменяются вручную во время работы класса
- Проверьте, что класс не инициализируется несколько раз

## Лицензия

Этот проект лицензирован в соответствии с Apache License 2.0 - см. файл [LICENSE](LICENSE) для получения подробностей.